# Research and Implementation of a Centralized Management and Processing System for Cyber Attack Events



# Project Overview

This project presents the design and implementation of a fully operational Security Information and Event Management (SIEM) platform leveraging the Elastic Stack. It centralizes the collection, processing, analysis, and visualization of security events generated by:

- Windows and Linux endpoints (event logs, syslogs)
- Network devices (pfSense firewall, Suricata IDS/IPS, Zeek)
- Web applications (Nginx access logs, ModSecurity WAF alerts)
- Elastic Agents for system and application metrics

Key objectives:

- Build a scalable, resilient Elastic Stack deployment (Elasticsearch, Logstash, Kibana, Fleet Server).
- Configure multi-source data ingestion and parsing pipelines.
- Implement network and host-based intrusion detection (Suricata, Zeek).
- Enforce web application protection with ModSecurity and OWASP CRS.
- Develop dashboards, alerts, and detection rules with Elastic Security (MITRE ATT&CK alignment).


# System Architecture

![System Architecture](img/deployment-architecture.png)

### Network Topology & Segmentation

|Name| CIDR             | Purpose                                |
|-----|------------------|----------------------------------------|
|NAT| 192.168.71.0/24  | NAT network (Internet egress)          |
|Host-Only 1| 192.168.85.0/24  | Segment: pfSense ↔ Suricata/Zeek            |
|Host-Only 2| 192.168.41.0/24  | Segment: Suricata ↔ WAF/Web Servers/Clients  |
|Host-Only 3|  10.81.85.0/24| Attacker network                   |
|Host-Only 4| 192.168.100.0/24 | SIEM Server LAN                        |

### Data Flow & Components

![Data Flow](img/elastic-agents.png)

1. **Fleet Server & Elastic Agents**
   - Elastic Agents enroll via Fleet Server and receive policies for log, metric, endpoint, and security data collection.
2. **Log Collection**
   - Filebeat modules and Elastic Agents forward logs from Windows Event Logs, syslog, Nginx, pfSense, and Suricata to Logstash.
   - Zeek captures network traffic and generates detailed session logs (conn, http, dns, ssl).
3. **Data Processing**
   - Logstash pipelines parse, normalize (ECS), enrich (geoip, user_agent), and route events to Elasticsearch indices.
4. **Storage & Analysis**
   - Elasticsearch cluster stores indexed data with ILM policies for retention and rollover.
   - Elastic Security app in Kibana enables detection rules, threat maps, and case management.
5. **Visualization & Alerting**
   - Kibana dashboards display security metrics (login trends, IDS alerts, WAF blocks).
   - Watchers and alerts notify via email/Slack on critical events.


## Core Technologies

- **Elastic Stack & Fleet**: Elasticsearch, Logstash, Kibana, Fleet Server, Elastic Agent
- **Intrusion Detection & Analysis**:
  - Suricata (inline IDS/IPS)
  - Zeek (network traffic analysis)
- **Web Application Firewall**: ModSecurity with OWASP Core Rule Set
- **Reverse Proxy & Security**: Nginx for HTTPS termination and access control
- **Detection & Analytics**:
  - Elastic Security rules (built-in and custom, MITRE ATT&CK mapped)
  - Kibana Query Language (KQL) and Elasticsearch Query DSL
- **Simulation Environment**: Metasploitable2, attacker VM for generating test events


## Repository Structure

```
├── config/                  # Configuration files for Logstash, Filebeat, Suricata, ModSecurity, Nginx
├── demo/                    # Demo video
├── docs/                    # Detailed documentation and project reports
├── img/                     # Image for demo
├── install/                 # Install Guide
└── src/                     # Sources Code
```


## Prerequisites

- **Hardware**: Ubuntu with ≥4 GB RAM, ≥4 vCPU
- **Software**:
  - Ubuntu 20.04+ (server and VMs)
  - Elasticsearch 8.x, Kibana 8.x, Logstash 8.x
  - Fleet Server and Elastic Agent 8.x
  - pfSense 2.5+, Suricata 6.x, Zeek 4.x
  - Nginx 1.18+, ModSecurity 3.x
- **Network**: Host-Only and NAT interfaces configured per topology above


# Installation & Deployment

See [install/](install/) for more details.


# Security Hardening

- **TLS/SSL**: Self-signed certificates for Nginx and Elasticsearch transport.
- **Authentication & RBAC**: Custom roles (`kibana_user`, `logstash_writer`) and users.
- **Index Lifecycle Management**: Hot–Warm–Cold phases and automated deletion after 30 days.


# Glossary

- **ECS**: Elastic Common Schema
- **KQL**: Kibana Query Language
- **ILM**: Index Lifecycle Management
- **Fleet**: Elastic Agent management system
- **Integration**: Pre-built package for data collection and dashboards


# Future Work

- Expand Zeek integration via Fleet and custom parsers.
- Enable Elastic Machine Learning jobs for anomaly detection.
- Implement automated playbooks for incident response.


# References

1. Elastic Stack Documentation — https://www.elastic.co/guide
2. Suricata Official Docs — https://suricata-ids.org
3. Zeek Network Security Monitor — https://zeek.org
4. ModSecurity Handbook — https://www.modsecurity.org
5. MITRE ATT&CK — https://attack.mitre.org


# Collaborator
- **Lại Quan Thiên** - [WanThinnn](https://github.com/WanThinnn)
- **Hồ Diệp Huy** - [hohuyy](https://github.com/hohuyy)
